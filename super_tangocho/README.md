# 多機能単語帳アプリ

Google Apps Scriptで作成された高機能な英単語学習アプリです。

## 📋 主な機能

### 1. 英単語・熟語の管理
- スプレッドシートに単語データを保存
- 英語、日本語訳、例文、正解/不正解回数、最終学習日を記録

### 2. 自動翻訳機能
- 選択範囲またはシート全体の空白セルに自動翻訳を挿入
- Google翻訳APIを使用した高精度な翻訳

### 3. 例文自動生成
- Groq APIを使用してAIが自然な例文を自動生成
- 例文の日本語訳も自動で挿入

### 4. 読み上げ機能
- Web Speech APIを使用した音声読み上げ
- 英語、日本語、例文の読み上げに対応
- 速度調整、順序カスタマイズ可能
- 選択セルまたはシート全体を連続読み上げ

### 5. ４択チャレンジ
- 3つの出題タイプ（英→日、日→英、例文穴埋め）
- 10問、50問、100問から選択可能
- 苦手な単語や前回学習から時間が経った単語を優先出題
- 正解/不正解回数を自動記録
- 忘却曲線に基づいた学習サポート

## 🚀 セットアップ

### 1. Google Spreadsheetでの設定

1. Google Spreadsheetを新規作成
2. メニューから「拡張機能」→「Apps Script」を開く
3. 以下のファイルをコピー＆ペースト：
   - `ai_generated.js` → Code.gs
   - `Sidebar.html` → 新しいHTMLファイル「Sidebar」
   - `Challenge.html` → 新しいHTMLファイル「Challenge」

### 2. Groq APIキーの取得と設定

1. [Groq Console](https://console.groq.com/)でアカウントを作成
2. APIキーを発行
3. スプレッドシートのメニュー「単語帳アプリ」→「設定」→「Groq APIキーを設定」
4. 発行したAPIキーを入力

### 3. シートの初期化

スクリプトエディタで以下の関数を実行：
```javascript
initializeWordDataSheet()
```

これにより「単語データ」シートが自動作成されます。

## 📊 シート構成

### 単語データシート

| A列 | B列 | C列 | D列 | E列 | F列 | G列 | H列 |
|-----|-----|-----|-----|-----|-----|-----|-----|
| 苦手 | 英語 | 日本語訳 | 例文 | 例文（日本語訳） | 正解回数 | 不正解回数 | 最終学習日 |

## 💡 使い方

### サイドバーの起動
メニュー「単語帳アプリ」→「サイドバーを開く」

### 翻訳機能の使い方
1. サイドバーから「シート全体の空白を翻訳」または「選択範囲を翻訳」をクリック
2. 自動的に翻訳が挿入されます

### 例文生成の使い方
1. サイドバーから「例文を自動生成」をクリック
2. Groq APIが例文を生成（数秒～数分かかります）
3. 例文と日本語訳が自動で挿入されます

### 読み上げ機能の使い方
1. サイドバーで読み上げ範囲を選択（選択セル/シート全体）
2. 読み上げ項目をチェック（英語、日本語訳、例文など）
3. 速度や間隔を調整
4. 「▶ 再生」ボタンをクリック
5. 「⏹ 停止」で中断可能

### ４択チャレンジの使い方
1. メニュー「単語帳アプリ」→「４択チャレンジを開始」
2. 問題タイプ、出題範囲、問題数を設定
3. 「チャレンジ開始」をクリック
4. 4つの選択肢から正解を選ぶ
5. 結果が自動記録され、苦手な単語が判定されます

## 🔧 カスタマイズ

### 列の変更
`COLUMN_INDEX`定数を編集することで、列の位置を変更できます。

### APIモデルの変更
Groq APIのモデルを変更する場合は、`generateExampleSentence`関数内の`model`パラメータを編集してください。

## 📝 注意事項

- Groq APIは無料枠がありますが、使用量に注意してください
- 読み上げ機能はブラウザのWeb Speech APIを使用するため、ブラウザによって音声が異なります
- 大量の単語を処理する場合、時間がかかることがあります

## 🐛 トラブルシューティング

### 翻訳が機能しない
- Google Apps Scriptの実行権限を確認してください
- LanguageAppのクォータ制限に達していないか確認してください

### 例文生成が失敗する
- Groq APIキーが正しく設定されているか確認してください
- APIのクォータ制限に達していないか確認してください

### 読み上げが機能しない
- ブラウザがWeb Speech APIをサポートしているか確認してください
- Chrome、Edge、Safariでの使用を推奨します

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🤝 貢献

バグ報告や機能追加の提案は、GitHubのIssuesでお願いします。
